{
  "input": {
    "self": {
      "username": "user",
      "password": "pass",
      "last_nonce": "",
      "nonce_count": 0,
      "chal": {
        "realm": "me@kennethreitz.com",
        "nonce": "2cb6ca3bd92f46300c21bc6652450899",
        "qop": "auth",
        "opaque": "3b88561378508443a8b14a91ec359904",
        "algorithm": "MD5",
        "stale": "FALSE"
      },
      "pos": null,
      "num_401_calls": 2
    },
    "args": {
      "method": "GET",
      "url": "http://httpbin.org/digest-auth/auth/user/pass"
    },
    "kwargs": {}
  },
  "branches": {
    "total": 16,
    "taken": 10,
    "not_taken": 9,
    "decisions": [
      {
        "line": 31,
        "type": "if",
        "condition": "algorithm is None",
        "taken": true,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904"
        }
      },
      {
        "line": 35,
        "type": "if",
        "condition": "_algorithm == 'MD5' or _algorithm == 'MD5-SESS'",
        "taken": true,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904"
        }
      },
      {
        "line": 41,
        "type": "elif",
        "condition": "_algorithm == 'SHA'",
        "taken": false,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904"
        }
      },
      {
        "line": 50,
        "type": "if",
        "condition": "hash_utf8 is None",
        "taken": false,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>"
        }
      },
      {
        "line": 56,
        "type": "if",
        "condition": "p_parsed.query",
        "taken": false,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass"
        }
      },
      {
        "line": 37,
        "type": "if",
        "condition": "isinstance(x, str)",
        "taken": true,
        "function": "md5_utf8",
        "variables": {
          "x": "user:me@kennethreitz.com:pass"
        }
      },
      {
        "line": 37,
        "type": "if",
        "condition": "isinstance(x, str)",
        "taken": true,
        "function": "md5_utf8",
        "variables": {
          "x": "GET:/digest-auth/auth/user/pass"
        }
      },
      {
        "line": 65,
        "type": "if",
        "condition": "nonce == self.last_nonce",
        "taken": true,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470"
        }
      },
      {
        "line": 77,
        "type": "if",
        "condition": "_algorithm == 'MD5-SESS'",
        "taken": false,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470",
          "ncvalue": "00000001",
          "s": "b'12cb6ca3bd92f46300c21bc6652450899Sun Jan 11 16:39:32 2026\\rp\\xb8\\xb9@\\xd5<\\xac'",
          "cnonce": "c094bceef2ed7121",
          "noncebit": "2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470"
        }
      },
      {
        "line": 80,
        "type": "if",
        "condition": "qop is None",
        "taken": false,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470",
          "ncvalue": "00000001",
          "s": "b'12cb6ca3bd92f46300c21bc6652450899Sun Jan 11 16:39:32 2026\\rp\\xb8\\xb9@\\xd5<\\xac'",
          "cnonce": "c094bceef2ed7121",
          "noncebit": "2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470"
        }
      },
      {
        "line": 82,
        "type": "elif",
        "condition": "qop == 'auth' or 'auth' in qop.split(',')",
        "taken": true,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470",
          "ncvalue": "00000001",
          "s": "b'12cb6ca3bd92f46300c21bc6652450899Sun Jan 11 16:39:32 2026\\rp\\xb8\\xb9@\\xd5<\\xac'",
          "cnonce": "c094bceef2ed7121",
          "noncebit": "2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470"
        }
      },
      {
        "line": 37,
        "type": "if",
        "condition": "isinstance(x, str)",
        "taken": true,
        "function": "md5_utf8",
        "variables": {
          "x": "ce05865592809b7d2643d4a2426f6b77:2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470"
        }
      },
      {
        "line": 91,
        "type": "if",
        "condition": "opaque",
        "taken": true,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470",
          "ncvalue": "00000001",
          "s": "b'12cb6ca3bd92f46300c21bc6652450899Sun Jan 11 16:39:32 2026\\rp\\xb8\\xb9@\\xd5<\\xac'",
          "cnonce": "c094bceef2ed7121",
          "noncebit": "2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470",
          "respdig": "be5894999fb0f7d02ade96f97c016fb9",
          "base": "username=\"user\", realm=\"me@kennethreitz.com\", nonce=\"2cb6ca3bd92f46300c21bc6652450899\", uri=\"/digest-auth/auth/user/pass\", response=\"be5894999fb0f7d02ade96f97c016fb9\""
        }
      },
      {
        "line": 93,
        "type": "if",
        "condition": "algorithm",
        "taken": true,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470",
          "ncvalue": "00000001",
          "s": "b'12cb6ca3bd92f46300c21bc6652450899Sun Jan 11 16:39:32 2026\\rp\\xb8\\xb9@\\xd5<\\xac'",
          "cnonce": "c094bceef2ed7121",
          "noncebit": "2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470",
          "respdig": "be5894999fb0f7d02ade96f97c016fb9",
          "base": "username=\"user\", realm=\"me@kennethreitz.com\", nonce=\"2cb6ca3bd92f46300c21bc6652450899\", uri=\"/digest-auth/auth/user/pass\", response=\"be5894999fb0f7d02ade96f97c016fb9\", opaque=\"3b88561378508443a8b14a91ec359904\""
        }
      },
      {
        "line": 95,
        "type": "if",
        "condition": "entdig",
        "taken": false,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470",
          "ncvalue": "00000001",
          "s": "b'12cb6ca3bd92f46300c21bc6652450899Sun Jan 11 16:39:32 2026\\rp\\xb8\\xb9@\\xd5<\\xac'",
          "cnonce": "c094bceef2ed7121",
          "noncebit": "2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470",
          "respdig": "be5894999fb0f7d02ade96f97c016fb9",
          "base": "username=\"user\", realm=\"me@kennethreitz.com\", nonce=\"2cb6ca3bd92f46300c21bc6652450899\", uri=\"/digest-auth/auth/user/pass\", response=\"be5894999fb0f7d02ade96f97c016fb9\", opaque=\"3b88561378508443a8b14a91ec359904\", algorithm=\"MD5\""
        }
      },
      {
        "line": 97,
        "type": "if",
        "condition": "qop",
        "taken": true,
        "function": "build_digest_header",
        "variables": {
          "method": "GET",
          "url": "http://httpbin.org/digest-auth/auth/user/pass",
          "realm": "me@kennethreitz.com",
          "nonce": "2cb6ca3bd92f46300c21bc6652450899",
          "qop": "auth",
          "algorithm": "MD5",
          "opaque": "3b88561378508443a8b14a91ec359904",
          "md5_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "hash_utf8": "<function HTTPDigestAuth.build_digest_header.<locals>.md5_utf8 at 0x7900a03b8f70>",
          "KD": "<function HTTPDigestAuth.build_digest_header.<locals>.<lambda> at 0x7900a03b3280>",
          "entdig": null,
          "p_parsed": [
            "http",
            "httpbin.org",
            "/digest-auth/auth/user/pass",
            "",
            "",
            ""
          ],
          "path": "/digest-auth/auth/user/pass",
          "A1": "user:me@kennethreitz.com:pass",
          "A2": "GET:/digest-auth/auth/user/pass",
          "HA1": "ce05865592809b7d2643d4a2426f6b77",
          "HA2": "882a6989edd5ee32b06920d4a5077470",
          "ncvalue": "00000001",
          "s": "b'12cb6ca3bd92f46300c21bc6652450899Sun Jan 11 16:39:32 2026\\rp\\xb8\\xb9@\\xd5<\\xac'",
          "cnonce": "c094bceef2ed7121",
          "noncebit": "2cb6ca3bd92f46300c21bc6652450899:00000001:c094bceef2ed7121:auth:882a6989edd5ee32b06920d4a5077470",
          "respdig": "be5894999fb0f7d02ade96f97c016fb9",
          "base": "username=\"user\", realm=\"me@kennethreitz.com\", nonce=\"2cb6ca3bd92f46300c21bc6652450899\", uri=\"/digest-auth/auth/user/pass\", response=\"be5894999fb0f7d02ade96f97c016fb9\", opaque=\"3b88561378508443a8b14a91ec359904\", algorithm=\"MD5\""
        }
      }
    ]
  },
  "name": "build_digest_header"
}