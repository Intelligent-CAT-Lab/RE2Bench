{
    "scikit-learn.sklearn.decomposition._lda._e_step": "def _e_step(self, X, cal_sstats, random_init, parallel=None):\n    \"\"\"E-step in EM update.\n\n    Parameters\n    ----------\n    X : {array-like, sparse matrix} of shape (n_samples, n_features)\n        Document word matrix.\n\n    cal_sstats : bool\n        Parameter that indicate whether to calculate sufficient statistics\n        or not. Set ``cal_sstats`` to True when we need to run M-step.\n\n    random_init : bool\n        Parameter that indicate whether to initialize document topic\n        distribution randomly in the E-step. Set it to True in training\n        steps.\n\n    parallel : joblib.Parallel, default=None\n        Pre-initialized instance of joblib.Parallel.\n\n    Returns\n    -------\n    (doc_topic_distr, suff_stats) :\n        `doc_topic_distr` is unnormalized topic distribution for each\n        document. In the literature, this is called `gamma`.\n        `suff_stats` is expected sufficient statistics for the M-step.\n        When `cal_sstats == False`, it will be None.\n\n    \"\"\"\n\n    # Run e-step in parallel\n    random_state = self.random_state_ if random_init else None\n\n    # TODO: make Parallel._effective_n_jobs public instead?\n    n_jobs = effective_n_jobs(self.n_jobs)\n    if parallel is None:\n        parallel = Parallel(n_jobs=n_jobs, verbose=max(0, self.verbose - 1))\n    results = parallel(\n        delayed(_update_doc_distribution)(\n            X[idx_slice, :],\n            self.exp_dirichlet_component_,\n            self.doc_topic_prior_,\n            self.max_doc_update_iter,\n            self.mean_change_tol,\n            cal_sstats,\n            random_state,\n        )\n        for idx_slice in gen_even_slices(X.shape[0], n_jobs)\n    )\n\n    # merge result\n    doc_topics, sstats_list = zip(*results)\n    doc_topic_distr = np.vstack(doc_topics)\n\n    if cal_sstats:\n        # This step finishes computing the sufficient statistics for the\n        # M-step.\n        suff_stats = np.zeros(self.components_.shape, dtype=self.components_.dtype)\n        for sstats in sstats_list:\n            suff_stats += sstats\n        suff_stats *= self.exp_dirichlet_component_\n    else:\n        suff_stats = None\n\n    return (doc_topic_distr, suff_stats)"
}