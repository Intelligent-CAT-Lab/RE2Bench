[OUTPUT]

1 from numbers import Integral, Real
2 import numpy as np
3 from scipy import linalg
4 from sklearn.utils._param_validation import Interval, StrOptions, validate_params
5 from sklearn.utils.validation import check_is_fitted, check_non_negative, validate_data
6 
7 class MiniBatchNMF(_BaseNMF):
8     _parameter_constraints: dict = {**_BaseNMF._parameter_constraints, 'max_no_improvement': [Interval(Integral, 1, None, closed='left'), None], 'batch_size': [Interval(Integral, 1, None, closed='left')], 'forget_factor': [Interval(Real, 0, 1, closed='both')], 'fresh_restarts': ['boolean'], 'fresh_restarts_max_iter': [Interval(Integral, 1, None, closed='left')], 'transform_max_iter': [Interval(Integral, 1, None, closed='left'), None]}
9 
10     def __init__(self, n_components='auto', *, init=None, batch_size=1024, beta_loss='frobenius', tol=0.0001, max_no_improvement=10, max_iter=200, alpha_W=0.0, alpha_H='same', l1_ratio=0.0, forget_factor=0.7, fresh_restarts=False, fresh_restarts_max_iter=30, transform_max_iter=None, random_state=None, verbose=0):
11         super().__init__(n_components=n_components, init=init, beta_loss=beta_loss, tol=tol, max_iter=max_iter, random_state=random_state, alpha_W=alpha_W, alpha_H=alpha_H, l1_ratio=l1_ratio, verbose=verbose)
12         self.max_no_improvement = max_no_improvement
13         self.batch_size = batch_size
14         self.forget_factor = forget_factor
15         self.fresh_restarts = fresh_restarts
16         self.fresh_restarts_max_iter = fresh_restarts_max_iter
17         self.transform_max_iter = transform_max_iter
18 
19     def _solve_W(self, X, H, max_iter):
20         avg = np.sqrt(X.mean() / self._n_components)
21         W = np.full((X.shape[0], self._n_components), avg, dtype=X.dtype)
22         W_buffer = W.copy()
23         l1_reg_W, _, l2_reg_W, _ = self._compute_regularization(X)
24         for _ in range(max_iter):## [STATE]_=0[/STATE] [STATE]range(max_iter)=range(200)[/STATE]
25             W, *_ = _multiplicative_update_w(X, W, H, self._beta_loss, l1_reg_W, l2_reg_W, self._gamma)
26             W_diff = linalg.norm(W - W_buffer) / linalg.norm(W)
27             if self.tol > 0 and W_diff <= self.tol:
28                 break
29             W_buffer[:] = W
30         return W
31 
32     def transform(self, X):
33         check_is_fitted(self)
34         X = validate_data(self, X, accept_sparse=('csr', 'csc'), dtype=[np.float64, np.float32], reset=False)
35         W = self._solve_W(X, self.components_, self._transform_max_iter)
36         return W
[/OUTPUT]
[/INST]

[FILEPATH] RLButt0n-ToroFusion-273d432/fill-in-the-loops/fill_in_the_loops-3-3shot.json [/FILEPATH]
{
    "cov_sources": [
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Atari 2600 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Atari 7800 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Computer Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Java Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/JVM Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Kernel Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Kernel Header Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Linux Containers Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Mac Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/NetBSD Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/OpenBSD Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Oracle Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/TCC Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Win 7 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Win 10 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Win 11 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Win Embedded Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Win Phone 8 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Win Phone Win RT Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Windows 2k Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Windows 2k3 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Windows 8 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Windows Embedded Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Windows Vista Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Windows XP Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/Windows XP Server Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/aarch64 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/arm64 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/libsystem Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/mapi Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/minix Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/riscv32 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/riscv64 Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/sun Contracts.txt?download=true",
        "https://huggingface.co/datasets/asetcode/AGV_2023_2024/resolve/main/xbox360 Contracts.txt?download=true"
    ],
    "exclude_fns": [
        "cygwin1.dll",
        "cyggcc_s-1.dll",
        "cygintl-3.dll",
        "cygmp-3.dll",
        "cygncursesw-10.dll",
        "cygstdc++-6.dll",
        "cygz.dll",
        "KERNEL32.dll",
        "cimwin32.dll",
        "gdiplus.dll",
        "wmp.dll",
        "wpcap.dll",
        "freebl3.dll",
        "icuuc52.dll",
        "intl.dll",
        "jinput-w32.dll",
        "jinput-dx8.dll",
        "jinput-raw.dll",
        "SDL.dll",
        "libFLAC-8.dll",
        "libgcj-12.dll",
        "libgobject-2.0-0.dll",
        "libgthread-2.0-0.dll",
        "libgnomecanvas-2.0-0.dll",
        "libgnomeui-2.0-0.dll",
        "libgomp-1.dll",
        "libgtk-win32-2.0-0.dll",
        "libgtk-x11-2.0-0.dll",
        "libiconv-2.dll",
        "libidn-11.dll",
        "libjson-glib-1.0-0.dll",
        "libmount.dll",
        "libmpg123-0.dll",
        "libodbcinst.dll",
        "libodbcinstQ4.dll",
        "liboil-0.3-0.dll",
        "libpango-1.0-0.dll",
        "libpangocairo-1.0-0.dll",
        "libpangoft2-1.0-0.dll",
        "libpangowin32-1.0-0.dll",
        "libpangox-1.0-0.dll",
        "libpcsclite.dll",
        "libpopt-0.dll",
        "libpoppler.dll",
        "libreadline6.dll",
        "libsmime3.dll",
        "libssl3.dll",
        "libthai.dll",
        "libtiff-3.dll",
        "libusb0.dll",
        "libX11-6.dll",
        "libXau-6.dll",
        "libxcb-1.dll",
        "libXcomposite-1.dll",
        "libxcursor-1.dll",
        "libXdamage-1.dll",
        "libXdmcp-6.dll",
        "libXext-6.dll",
        "libXfixes-3.dll",
        "libXfont-1.dll",
        "libXi-6.dll",
        "libXinerama-1.dll",
        "libXrandr-2.dll",
        "libXrender-1.dll",
        "libXtst-6.dll",
        "libzstd.dll",
        "libgcc_s_dw2-1.dll",
        "libgcc_s_sjlj-1.dll",
        "libtasn1-6.dll",
        "libwinpthread-1.dll",
        "ltdl.dll",
        "mpg123.dll",
        "nss3.dll",
        "pcsc.dll",
        "stdc++-6.dll",
        "USER32.dll",
        "Ws2_32.dll",
        "ADVAPI32.dll",
        "BAKERFC.dll",
        "CHARMAP.dll",
        "COMCTL32.dll",
        "DBNETLIB.dll",
        "DCOMSCFG.dll",
        "DEVOBJ.dll",
        "DWMCOMPOS.dll",
        "FILEXSRC.dll",
        "GDI32.dll",
        "HID.dll",
        "INETECC.dll",
        "MSTLSAPI.dll",
        "NETAPI32.dll",
        "NMPRD32.dll",
        "NSI.dll",
        "NTMARTA.dll",
        "RPCRT4.dll",
        "SHCORE.dll",
        "SHDOCVW.dll",
        "SLWGA.dll",
        "THEMESVC.dll",
        "ULARGEFONT.dll",
        "URLMON.dll",
        "WINTAB32.dll",
        "appmgmts.dll",
        "battmeta.dll",
        "bcrypt.dll",
        "browseui.dll",
        "cabinet.dll",
        "certcli.dll",
        "cmicfgp.dll",
        "comdlg32.dll",
        "compact.dll",
        "comres.dll",
        "configfs.dll",
        "cryptbase.dll",
        "cryptui.dll",
        "cryptxml.dll",
        "ctfmon.dll",
        "crtutils.dll",
        "dbgeng.dll",
        "dbgmodel.dll",
        "dbghelp.dll",
        "deskadp.dll",
        "devmgr.dll",
        "dinput8.dll",
        "dlang.dll",
        "dmutil.dll",
        "dpnet.dll",
        "dpx.dll",
        "dxgi.dll",
        "faultrep.dll",
        "fdh.dll",
        "fveapi.dll",
        "fsutil.dll",
        "fuse_filter_engine.dll",
        "hdr.dll",
        "imm32.dll",
        "infoware.dll",
        "inseng.dll",
        "iphlpapi.dll",
        "kbctray.dll",
        "locale.dll",
        "lpk.dll",
        "magnification.dll",
        "manage.dll",
        "mbnapi.dll",
        "mobsync.dll",
        "monitor.dll",
        "mpclient.dll",
        "mpeg4cmn.dll",
        "mrxsmb10.dll",
        "mrxsmb20.dll",
        "mssprxy.dll",
        "msgacces.dll",
        "mstask.dll",
        "msvcrt.dll",
        "msvcrt20.dll",
        "msvcrt40.dll",
        "ndfapi.dll",
        "ndproxystub.dll",
        "netplwiz.dll",
        "nksprv.dll",
        "nucoref.dll",
        "ocmanager.dll",
        "oleacc.dll",
        "oltffmgr.dll",
        "oobefldr.dll",
        "p2p.dll",
        "pdm.dll",
        "perfcntr.dll",
        "pnrpnsp.dll",
        "profapi.dll",
        "propsys.dll",
        "psapi.dll",
        "pvf.dll",
        "qcap.dll",
        "qdevice.dll",
        "qedit.dll",
        "rassrv32.dll",
        "rdscom.dll",
        "resutils.dll",
        "rsabase.dll",
        "runonce.exe",
        "scrrun.dll",
        "sdhcinst.dll",
        "searchapi.dll",
        "sensorsapi.dll",
        "setupapi.dll",
        "sfc_os.dll",
        "shfolder.dll",
        "shell32.dll",
        "showeng.dll",
        "slc.dll",
        "slcext.dll",
        "slwga.dll",
        "stobject.dll",
        "sxs.dll",
        "telnet.dll",
        "tlbapi.dll",
        "tmschema.dll",
        "tntsrch.dll",
        "uxtheme.dll",
        "wbemess.dll",
        "wdscore.dll",
        "wdsdriver.dll",
        "wdsml.dll",
        "wdsusb.dll",
        "wbondsup.dll",
        "wfdahc.dll",
        "wfplw.dll",
        "wiaacadm.dll",
        "wiadefui.dll",
        "wiadss.dll",
        "winbio.dll",
        "winsta.dll",
        "wldap32.dll",
        "wlbsctrl.dll",
        "wlbsdrv.dll",
        "wlmserver.dll",
        "wminet_utils.dll",
        "wmiutils.dll",
        "wofutil.dll",
        "wow64win.dll",
        "wow64winapi.dll",
        "ws2_32.dll",
        "wsbapp.dll",
        "wsgatm.dll",
        "wshbth.dll",
        "wshtcpip.dll",
        "wshwpd.dll",
        "wsock32.dll",
        "wtsapi32.dll",
        "xapofx11.dll",
        "xapofxprn.dll",
        "xpsprint.dll",
        "xpsr2res.dll",
        "wrpcrt.dll",
        "mxim.dll",
        "mxts.dll",
        "xpssvcs.dll",
        "bdatif.dll",
        "lz32.dll",
        "xmlsec.dll",
        "urlmon.dll",
        "d2d1.dll",
        "d3d10warp.dll",
        "d3d11.dll",
        "d3d9.dll",
        "d3d8thk.dll",
        "d3dx11_42.dll",
        "d3dx11_43.dll",
        "d3dx10_33.dll",
        "d3dx10_34.dll",
        "d3dx9_24.dll",
        "d3dx9_25.dll",
        "d3dx9_26.dll",
        "d3dx9_27.dll",
        "d3dx9_28.dll",
        "d3dx9_29.dll",
        "d3dx9_30.dll",
        "d3dx9_31.dll",
        "d3dx9_32.dll",
        "d3dx9_33.dll",
        "d3dx9_34.dll",
        "d3dx9_35.dll",
        "d3dx9_36.dll",
        "d3dx9_37.dll",
        "d3dx9_38.dll",
        "d3dx9_39.dll",
        "d3dx9_40.dll",
        "d3dx9_41.dll",
        "d