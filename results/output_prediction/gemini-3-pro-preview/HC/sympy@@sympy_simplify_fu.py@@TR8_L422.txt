The function `TR8` performs trigonometric power reduction, converting powers and products of sines and cosines into sums of sines and cosines of multiple angles. Specifically, it implements the reduction of $\cos^n(x) \sin^m(x)$.

**Execution Trace:**

1.  **Input:** `TR8` is called with `rv = cos(phi)**2` and `first = False`.
2.  **Inside `TR8`:** The function `f` is defined and passed to `bottom_up(rv, f)`.
3.  **`bottom_up` Traversal:**
    *   It recursively visits arguments. `cos(phi)**2` has arguments `cos(phi)` (base) and `2` (exponent).
    *   `cos(phi)` has argument `phi`.
    *   Leaves (`phi`, `2`) are processed by `f` but remain unchanged (bases/integers are not the target `Mul` or `Pow` forms).
    *   `cos(phi)` is processed by `f`. It is not a `Mul` or `Pow` (it's a function application), so `f` returns it unchanged.
    *   Finally, `f` is called on `cos(phi)**2`.
4.  **Application of `f(cos(phi)**2)`:**
    *   **Check conditions:**
        *   `rv.is_Pow` is True.
        *   `rv.base.func` is `cos`.
        *   `rv.exp` is `2` (integer).
        *   Conditions to proceed are met.
    *   **Argument collection:**
        *   `args` dictionary is initialized: `{cos: [], sin: [], None: []}`.
        *   The loop iterates over factors (here, just the single `Pow` term).
        *   It detects `cos(phi)**2`.
        *   It expands this into a list of arguments for `cos`: `c = [phi, phi]`.
    *   **Reduction Logic:**
        *   It checks if reduction is needed (`c` has 2 elements).
        *   It enters the loop `while len(c) > 1`.
        *   Pops `a1 = phi`, `a2 = phi`.
        *   Appends the term `(cos(a1 + a2) + cos(a1 - a2)) / 2`.
            *   `a1 + a2` = `2*phi`.
            *   `a1 - a2` = `0`.
            *   Term: `(cos(2*phi) + cos(0)) / 2` $\rightarrow$ `(cos(2*phi) + 1) / 2`.
    *   **Reconstruction:**
        *   The function returns `TR8(expand_mul(Mul(*args)))`.
        *   `args` contains `[(cos(2*phi) + 1) / 2]`.
        *   `Mul(*args)` is `(cos(2*phi) + 1) / 2`.
        *   `expand_mul` distributes the division: `cos(2*phi)/2 + 1/2`.
    *   **Recursive Call:**
        *   `TR8` is called on `cos(2*phi)/2 + 1/2`. The `first` argument defaults to `True` for this new call.
5.  **Recursive `TR8(..., first=True)`:**
    *   `bottom_up` runs on the sum.
    *   It visits `cos(2*phi)/2` (a `Mul`).
        *   `f` calls `TR8` on numerator `cos(2*phi)` and denominator `2` with `first=False`. Neither changes (cosine of multiple angle is not a power/product of trigs).
        *   Because `first=True`, the logic returns `rv` immediately after checking numer/denom, skipping further reduction on this node.
    *   It visits `1/2`. Unchanged.
    *   It visits the `Add` node. `f` returns `Add` unchanged.
6.  **Final Result:** The expression stabilizes at `cos(2*phi)/2 + 1/2`.

The logic corresponds to the identity $\cos^2(\phi) = \frac{1 + \cos(2\phi)}{2}$.

[OUTPUT]
```
{
    "output": "cos(2*phi)/2 + 1/2"
}
```
[/OUTPUT]