Let's go step by step.

The function `predict_binned` uses `_predict_from_binned_data` internally, which traverses the tree nodes for each sample in `X`.  
We have the `nodes` array in a structured dtype that matches `PREDICTOR_RECORD_DTYPE`.  

---

**Step 1 – Understanding the nodes structure**

From the dtype definition in `sklearn`, the fields and order are:

1. `value` (float64) – leaf value if leaf, otherwise unused.  
2. `count` (uint32) – sample count in the node.  
3. `feature_idx` (int64) – feature index used for splitting.  
4. `num_threshold` (float64) – threshold for numerical splits.  
5. `missing_go_to_left` (uint8) – 1 if missing goes to left child else 0.  
6. `left` (uint32) – index of left child.  
7. `right` (uint32) – index of right child.  
8. `gain` (float64) – split gain.  
9. `depth` (uint32) – node depth.  
10. `is_leaf` (uint8) – 1 if leaf, else 0.  
11. `bin_threshold` (uint8) – threshold for binned features (≤ go left).  
12. `is_categorical` (uint8) – 1 if categorical split.  
13. `bitset_idx` (uint32) – index into left cat bitsets if categorical.

---

**Step 2 – Our nodes data**

Looking at the provided nodes array (13 nodes, index 0 to 12):

Node 0:  
- value = 0.0  
- count = 45  
- feature_idx = 6  
- num_threshold = 1.03201754  
- missing_go_to_left = 1  
- left = 1  
- right = 12  
- gain = 1.47845364e+05  
- depth = 0  
- is_leaf = 0  
- bin_threshold = 38 (since bin_threshold is uint8)  
- is_categorical = 0  
- bitset_idx = 0  

Node 1:  
- value = -22.48230941  
- count = 39  
- feature_idx = 62  
- num_threshold = 0.79730976  
- missing_go_to_left = 1  
- left = 2  
- right = 11  
- gain = 9.18099090e+04  
- depth = 1  
- is_leaf = 0  
- bin_threshold = 37  
- is_categorical = 0  
- bitset_idx = 0  

Node 2:  
- value = -43.17091072  
- count = 33  
- feature_idx = 88  
- num_threshold = -0.06774434  
- missing_go_to_left = 1  
- left = 3  
- right = 8  
- gain = 7.04260316e+04  
- depth = 2  
- is_leaf = 0  
- bin_threshold = 26  
- is_categorical = 0  
- bitset_idx = 0  

Node 3:  
- value = -78.09222775  
- count = 21  
- feature_idx = 99  
- num_threshold = -0.50586178  
- missing_go_to_left = 0  
- left = 4  
- right = 5  
- gain = 5.98726019e+04  
- depth = 3  
- is_leaf = 0  
- bin_threshold = 13  
- is_categorical = 0  
- bitset_idx = 0  

Node 4:  
- value = 1.74244938  
- count = 5  
- feature_idx = 0  
- num_threshold = 0.0  
- missing_go_to_left = 0  
- left = 0  
- right = 0  
- gain = -1.0  
- depth = 4  
- is_leaf = 1  
- bin_threshold = 0  
- is_categorical = 0  
- bitset_idx = 0  

Node 5:  
- value = -107.94120324  
- count = 16  
- feature_idx = 80  
- num_threshold = 0.06851323  
- missing_go_to_left = 0  
- left = 6  
- right = 7  
- gain = 2.64970298e+04  
- depth = 4  
- is_leaf = 0  
- bin_threshold = 20  
- is_categorical = 0  
- bitset_idx = 0  

Node 6:  
- value = -6.72464325  
- count = 8  
- feature_idx = 0  
- num_threshold = 0.0  
- missing_go_to_left = 0  
- left = 0  
- right = 0  
- gain = -1.0  
- depth = 5  
- is_leaf = 1  
- bin_threshold = 0  
- is_categorical = 0  
- bitset_idx = 0  

Node 7:  
- value = -14.86359739  
- count = 8  
- feature_idx = 0  
- num_threshold = 0.0  
- missing_go_to_left = 0  
- left = 0  
- right = 0  
- gain = -1.0  
- depth = 5  
- is_leaf = 1  
- bin_threshold = 0  
- is_categorical = 0  
- bitset_idx = 0  

Node 8:  
- value = 17.94139409  
- count = 12  
- feature_idx = 1  
- num_threshold = 0.06772955  
- missing_go_to_left = 0  
- left = 9  
- right = 10  
- gain = 4.21864127e+04  
- depth = 3  
- is_leaf = 0  
- bin_threshold = 20  
- is_categorical = 0  
- bitset_idx = 0  

Node 9:  
- value = 8.8096566  
- count = 5  
- feature_idx = 0  
- num_threshold = 0.0  
- missing_go_to_left = 0  
- left = 0  
- right = 0  
- gain = -1.0  
- depth = 4  
- is_leaf = 1  
- bin_threshold = 0  
- is_categorical = 0  
- bitset_idx = 0  

Node 10:  
- value = -3.2169443  
- count = 7  
- feature_idx = 0  
- num_threshold = 0.0  
- missing_go_to_left = 0  
- left = 0  
- right = 0  
- gain = -1.0  
- depth = 4  
- is_leaf = 1  
- bin_threshold = 0  
- is_categorical = 0  
- bitset_idx = 0  

Node 11:  
- value = 9.13049978  
- count = 6  
- feature_idx = 0  
- num_threshold = 0.0  
- missing_go_to_left = 0  
- left = 0  
- right = 0  
- gain = -1.0  
- depth = 2  
- is_leaf = 1  
- bin_threshold = 0  
- is_categorical = 0  
- bitset_idx = 0  

Node 12:  
- value = 14.6135011  
- count = 6  
- feature_idx = 0  
- num_threshold = 0.0  
- missing_go_to_left = 0  
- left = 0  
- right = 0  
- gain = -1.0  
- depth = 1  
- is_leaf = 1  
- bin_threshold = 0  
- is_categorical = 0  
- bitset_idx = 0  

---

**Step 3 – Tree structure**

Root node 0:  
- `feature_idx` = 6, `bin_threshold` = 38, `is_categorical` = 0, `is_leaf` = 0  
- left = 1, right = 12  
- missing_go_to_left = 1  

If X[:, 6] <= 38 → go left to node 1, else go right to node 12.  
Node 12 is leaf with `value` = 14.6135011.

Node 1:  
- `feature_idx` = 62, `bin_threshold` = 37, `is_leaf` = 0  
- left = 2, right = 11  
- missing_go_to_left = 1  

If X[:, 62] <= 37 → go left to node 2, else go right to node 11 (leaf, value = 9.13049978).

Node 2:  
- `feature_idx` = 88, `bin_threshold` = 26, `is_leaf` = 0  
- left = 3, right = 8  
- missing_go_to_left = 1  

If X[:, 88] <= 26 → go left to node 3, else go right to node 8.

Node 3:  
- `feature_idx` = 99, `bin_threshold` = 13, `is_leaf` = 0, missing_go_to_left = 0  
- left = 4, right = 5  

If X[:, 99] <= 13 → go left to node 4 (leaf, value = 1.74244938), else go right to node 5.

Node 5:  
- `feature_idx` = 80, `bin_threshold` = 20, `is_leaf` = 0, missing_go_to_left = 0  
- left = 6, right = 7  

If X[:, 80] <= 20 → go left to node 6 (leaf, -6.72464325), else go right to node 7 (leaf, -14.86359739).

Node 8:  
- `feature_idx` = 1, `bin_threshold` = 20, `is_leaf` = 0, missing_go_to_left = 0  
- left = 9, right = 10  

If X[:, 1] <= 20 → go left to node 9 (leaf, 8.8096566), else go right to node 10 (leaf, -3.2169443).

---

**Step 4 – Apply to each sample**

`X` shape: (5, 100) – given 5 rows, 100 columns (since we have feature indices up to 99).  

We need to check the bin thresholds for each sample.

Sample 0 (first row of X):  
- Feature 6: X[0, 6] = 9 (from X[0] array: index 6 is 9).  
  9 ≤ 38 → go left to node 1.  
- Feature 62: X[0, 62] = ?  
  X[0] array: positions:  
  0:0, 1:33, 2:16, 3:8, 4:22, 5:28, 6:9, 7:44, 8:22, 9:16, 10:9, 11:34, 12:35, 13:15, 14:27, 15:10, 16:26, 17:40, 18:7, 19:1, 20:31, 21:35, 22:1, 23:27, 24:15, 25:31, 26:8, 27:10, 28:16, 29:43, 30:17, 31:33, 32:30, 33:36, 34:29, 35:16, 36:35, 37:12, 38:35, 39:16, 40:38, 41:11, 42:18, 43:42, 44:41, 45:10, 46:32, 47:38, 48:37, 49:42, 50:24, 51:42, 52:18, 53:22, 54:17, 55:36, 56:22, 57:0, 58:29, 59:12, 60:31, 61:21, 62:15, 63:22, 64:33, 65:44, 66:33, 67:32, 68:17, 69:14, 70:32, 71:37, 72:5, 73:16, 74:22, 75:1, 76:43, 77:33, 78:10, 79:0, 80:0, 81:37, 82:4, 83:6, 84:20, 85:44, 86:27, 87:13, 88:36, 89:12, 90:11, 91:0, 92:5, 93:36, 94:41, 95:22, 96:9, 97:28, 98:18, 99:19.  

  X[0, 62] = 15 (at position 62).  
  15 ≤ 37 → go left to node 2.  

- Feature 88: X[0, 88] = 36 (from above).  
  36 ≤ 26? No → go right to node 8.  

- Feature 1 (in node 8): X[0, 1] = 33.  
  33 ≤ 20? No → go right to node 10 (leaf value -3.2169443).  

So sample 0 prediction = -3.2169443.

---

Sample 1:  
- Feature 6: X[1, 6] = 37.  
  37 ≤ 38 → go left to node 1.  
- Feature 62: X[1, 62] = ?  
  Row 1 (index 1):  
  0:25, 1:41, 2:15, 3:8, 4:16, 5:28, 6:37, 7:28, 8:31, 9:23, 10:14, 11:8, 12:23, 13:6, 14:16, 15:43, 16:30, 17:37, 18:42, 19:8, 20:14, 21:9, 22:13, 23:35, 24:1, 25:42, 26:29, 27:34, 28:32, 29:39, 30:15, 31:28, 32:28, 33:14, 34:19, 35:5, 36:44, 37:3, 38:12, 39:32, 40:9, 41:6, 42:31, 43:15, 44:29, 45:9, 46:23, 47:42, 48:34, 49:22, 50:0, 51:30, 52:13, 53:9, 54:1, 55:9, 56:4, 57:32, 58:11, 59:42, 60:36, 61:37, 62:32, 63:13, 64:19, 65:10, 66:31, 67:41, 68:11, 69:22, 70:27, 71:36, 72:36, 73:36, 74:12, 75:32, 76:6, 77:10, 78:10, 79:4, 80:3, 81:33, 82:44, 83:36, 84:38, 85:0, 86:33, 87:20, 88:39, 89:11, 90:22, 91:24, 92:16, 93:13, 94:44, 95:29, 96:29, 97:29, 98:26, 99:27.  

  X[1, 62] = 32.  
  32 ≤ 37 → go left to node 2.  

- Feature 88: X[1, 88] = 39.  
  39 ≤ 26? No → go right to node 8.  

- Feature 1: X[1, 1] = 41.  
  41 ≤ 20? No → go right to node 10 (leaf -3.2169443).  

So sample 1 prediction = -3.2169443.

---

Sample 2:  
- Feature 6: X[2, 6] = 21.  
  21 ≤ 38 → go left to node 1.  
- Feature 62: X[2, 62] = ?  
  Row 2:  
  0:7, 1:5, 2:17, 3:38, 4:40, 5:26, 6:21, 7:24, 8:41, 9:2, 10:38, 11:15, 12:21, 13:44, 14:31, 15:13, 16:36, 17:22, 18:38, 19:10, 20:27, 21:17, 22:18, 23:9, 24:44, 25:27, 26:8, 27:14, 28:6, 29:23, 30:18, 31:37, 32:41, 33:17, 34:9, 35:24, 36:17, 37:42, 38:18, 39:42, 40:30, 41:12, 42:0, 43:27, 44:23, 45:10, 46:44, 47:26, 48:19, 49:21, 50:40, 51:18, 52:40, 53:2, 54:10, 55:31, 56:28, 57:10, 58:20, 59:42, 60:5, 61:36, 62:36, 63:43, 64:39, 65:20, 66:1, 67:37, 68:11, 69:14, 70:24, 